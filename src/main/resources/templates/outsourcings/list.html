<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>외주</title>
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/content.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/component.css">
    <script src="/js/jquery-1.11.3.min.js"></script>
    <script src="/js/jquery.easing.1.3.js"></script>
</head>
<body>

<!-- Main Content 시작 -->
<main>
    <div>
        <button type="button" onclick="window.location.href='http://localhost:8080/outsourcings/create'">외주 생성</button>
    </div>

    <h1>외주 목록</h1>
    <div id="outsourcing-container">
        <ul>
            <li th:each="item : ${apiResponse.content}" th:attr="data-id=${item.id}">
                <h3 th:text="${item.title}">외주 제목</h3>
                <p th:text="${item.content}">외주 설명</p>
                <p>작성자: <span th:text="${item.nickname}">작성자</span></p>
                <p>지역: <span th:text="${item.area}">지역 정보</span></p>
                <p>예산: <span th:text="${item.price}">예산 금액</span>원</p>

                <div>
                    <h4>첨부 이미지:</h4>
                    <ul>
                        <li th:each="filePath : ${item.filePaths}">
                            <img th:src="@{${filePath}}" alt="첨부 이미지" style="max-width: 200px; max-height: 150px;">
                        </li>
                    </ul>
                </div>
            </li>
        </ul>

        <p th:if="${#lists.isEmpty(apiResponse.content)}">데이터가 없습니다.</p>
    </div>

    <!-- 페이지 네이션 -->
    <div>
        <span th:text="'Page: ' + (${apiResponse.number + 1}) + ' / ' + ${apiResponse.totalPages}">페이지 정보</span>
    </div>

    <!-- 이전 및 다음 페이지 이동 버튼 -->
    <div style="margin-top: 20px;">
        <button type="button"
                th:disabled="${apiResponse.number == 0}"
                th:onclick="|window.location.href='/outsourcings/list?page=${apiResponse.number - 1}'|">
            이전 페이지
        </button>

        <button type="button"
                th:disabled="${apiResponse.number + 1 == apiResponse.totalPages}"
                th:onclick="|window.location.href='/outsourcings/list?page=${apiResponse.number + 1}'|">
            다음 페이지
        </button>
    </div>
</main>
<!-- Main Content 끝 -->

</body>
</html>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const outsourcingItems = document.querySelectorAll("#outsourcing-container li");

        outsourcingItems.forEach(item => {
            item.addEventListener("click", function() {
                const id = this.getAttribute("data-id");
                window.location.href = `detail/${id}`;
            });
        });
    });
</script>
